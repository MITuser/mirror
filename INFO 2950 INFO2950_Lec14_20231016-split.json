[{"pageContent":"INFO 2950: \n\nIntro to Data Science\n\n\nLecture 14\n\n2023-10-16\n\n1","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":1,"lines":{"from":1,"to":10}}}},{"pageContent":"Agenda\n\n1.\nBinary Evaluation Metrics\n\na.\nPrecision / Recall\n\nb.\nF1 / ROC-AUC\n\n\n\n2.\nTrain / test sets\n\na.\nCross Validation\n\nb.\nSliding Windows\n\n\n\n\n\n2","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":2,"lines":{"from":1,"to":27}}}},{"pageContent":"Precision and Recall\n\n●\nPrecision\n = tp / (tp + fp)\n\n\n\n\n●\nRecall\n = tp / (tp + fn)\n\n\n\n3\n\ntp\n\nfn\n\nfp\n\ntn\n\n   \nŷ\n=1      \nŷ\n=0\n\n y=0     y=1\n\ntp\n\nfn\n\nfp\n\ntn\n\n   \nŷ\n=1      \nŷ\n=0\n\n y=0     y=1","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":3,"lines":{"from":1,"to":48}}}},{"pageContent":"“True” Values Stay the Same\n\n●\nPositives\n = tp + fn\n\n\n●\nNegatives\n = fp + tn\n\n\n\n\n4\n\ntp\n\nfn\n\nfp\n\ntn\n\n   \nŷ\n=1      \nŷ\n=0\n\n y=0     y=1","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":4,"lines":{"from":1,"to":31}}}},{"pageContent":"“True” Values Stay the Same\n\n●\nPositives\n = tp + fn\n\n\n●\nNegatives\n = fp + tn\n\n\n\n\n5\n\ntp\n\nfn\n\nfp\n\ntn\n\n   \nŷ\n=1      \nŷ\n=0\n\n y=0     y=1\n\n●\nIf fn decreases, what happens to tp?\n\n\n\n\n\n琀\n琀","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":5,"lines":{"from":1,"to":41}}}},{"pageContent":"“True” Values Stay the Same\n\n●\nPositives\n = tp + fn\n\n\n●\nNegatives\n = fp + tn\n\n\n\n\n6\n\ntp\n\nfn\n\nfp\n\ntn\n\n   \nŷ\n=1      \nŷ\n=0\n\n y=0     y=1\n\n●\nIf fn decreases, what happens to tp?\n\n○\ntp increases since total positives \nmust stay the same","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":6,"lines":{"from":1,"to":38}}}},{"pageContent":"“True” Values Stay the Same\n\n●\nPositives\n = tp + fn\n\n\n●\nNegatives\n = fp + tn\n\n\n\n\n7\n\ntp\n\nfn\n\nfp\n\ntn\n\n   \nŷ\n=1      \nŷ\n=0\n\n y=0     y=1\n\n●\nIf tn increases, what happens to fp?\n\n\n\n\n\n\n琀\n琀","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":7,"lines":{"from":1,"to":42}}}},{"pageContent":"“True” Values Stay the Same\n\n●\nPositives\n = tp + fn\n\n\n●\nNegatives\n = fp + tn\n\n\n\n\n8\n\ntp\n\nfn\n\nfp\n\ntn\n\n   \nŷ\n=1      \nŷ\n=0\n\n y=0     y=1\n\n●\nIf tn increases, what happens to fp?\n\n○\nfp decreases since total negatives \nmust stay the same","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":8,"lines":{"from":1,"to":38}}}},{"pageContent":"How does recall change?\n\n●\nRecall\n \n= tp / (tp + fn)\n\n\n●\nIf we change our model so the number of false \nnegatives is decreased, what happens to \nrecall?\n\n○\nHint: let \np\n represent the number of true \ny=1 values in your data\n\n\n9\n\ntp\n\nfn\n\nfp\n\ntn\n\n   \nŷ\n=1      \nŷ\n=0\n\n y=0     y=1\n\n琀\n琀","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":9,"lines":{"from":1,"to":40}}}},{"pageContent":"●\nRecall\n \n= tp / (tp + fn)\n\n\n●\np = tp+fn\n\n\n\n10\n\ntp\n\nfn\n\nfp\n\ntn\n\n   \nŷ\n=1      \nŷ\n=0\n\n y=0     y=1\n\nHow does recall change?","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":10,"lines":{"from":1,"to":30}}}},{"pageContent":"●\nRecall\n \n= tp / (tp + fn)\n\n\n●\np = tp+fn\n\n●\nRecall = (p - fn) / (p)\n\n\n11\n\ntp\n\nfn\n\nfp\n\ntn\n\n   \nŷ\n=1      \nŷ\n=0\n\n y=0     y=1\n\nHow does recall change?","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":11,"lines":{"from":1,"to":32}}}},{"pageContent":"●\nRecall\n \n= tp / (tp + fn)\n\n\n●\np = tp+fn\n\n●\nRecall = (p - fn) / (p)\n\n\n12\n\ntp\n\nfn\n\nfp\n\ntn\n\n   \nŷ\n=1      \nŷ\n=0\n\n y=0     y=1\n\nHow does recall change?","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":12,"lines":{"from":1,"to":32}}}},{"pageContent":"●\nRecall\n \n= tp / (tp + fn)\n\n\n●\np = tp+fn\n\n●\nRecall = (p - fn) / (p)\n\n                = 1 - (fn/p)\n\n\n13\n\ntp\n\nfn\n\nfp\n\ntn\n\n   \nŷ\n=1      \nŷ\n=0\n\n y=0     y=1\n\nHow does recall change?","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":13,"lines":{"from":1,"to":34}}}},{"pageContent":"●\nRecall\n \n= tp / (tp + fn)\n\n\n●\np = tp+fn\n\n●\nRecall = (p - fn) / (p)\n\n                = 1 - (fn/p)\n\n●\nIf fn decreases, (fn/p) decreases since p is constant\n\n14\n\ntp\n\nfn\n\nfp\n\ntn\n\n   \nŷ\n=1      \nŷ\n=0\n\n y=0     y=1\n\nHow does recall change?","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":14,"lines":{"from":1,"to":36}}}},{"pageContent":"●\nRecall\n \n= tp / (tp + fn)\n\n\n●\np = tp+fn\n\n●\nRecall = (p - fn) / (p)\n\n                = 1 - (fn/p)\n\n●\nIf fn decreases, (fn/p) decreases since p is constant\n\n●\n...so, recall [1-(fn/p)] \nalways increases\n\n15\n\ntp\n\nfn\n\nfp\n\ntn\n\n   \nŷ\n=1      \nŷ\n=0\n\n y=0     y=1\n\nHow does recall change?","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":15,"lines":{"from":1,"to":40}}}},{"pageContent":"Before we talk about precision,\n\nlet’s talk about the model itself\n\n16\n\nTrue positive\n\nCorrect prediction\n\nFalse negative\n\n\nFalse positive\n\nTrue negative\n\nCorrect prediction\n\n      Model predicts 1\n\n      \n\n     \n\nModel predicts 0\n\n          True value is 0\n\n True value is 1","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":16,"lines":{"from":1,"to":30}}}},{"pageContent":"What model do we use for \nbinary output?\n\n17\n\nTrue positive\n\nCorrect prediction\n\nFalse negative\n\n\nFalse positive\n\nTrue negative\n\nCorrect prediction\n\n      Model predicts 1\n\n      \n\n     \n\nModel predicts 0\n\n          True value is 0\n\n True value is 1","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":17,"lines":{"from":1,"to":29}}}},{"pageContent":"18","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":18,"lines":{"from":1,"to":1}}}},{"pageContent":"Logistic regression\n\n19\n\n●\nWhen do we use it?\n\n○\nWhen output is \n_______","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":19,"lines":{"from":1,"to":10}}}},{"pageContent":"Logistic regression\n\n20\n\n●\nWhen do we use it?\n\n○\nWhen output is \nbinary\n\n\n●\nWhen you predict the \nŷ\n for a given value of \nx, what do you get?\n\n○\nIs \nŷ\n binary?\n\n○\nWhat’s going on under the hood?","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":20,"lines":{"from":1,"to":25}}}},{"pageContent":"21","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":21,"lines":{"from":1,"to":1}}}},{"pageContent":"How do you get from probability \nto binary?\n\n22\n\n●\nLogistic regression interpretation (e.g. the \n“summarize” step) regards the odds of y=1\n\n\n○\ni.e., logit tells you about the \nprobability \nthat y=1","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":22,"lines":{"from":1,"to":14}}}},{"pageContent":"Sort the points by p (logistic output)\n\n23\n\nWe have to make a decision. \nHow do we divide these?","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":23,"lines":{"from":1,"to":6}}}},{"pageContent":"Sort the points by p (logistic output)\n\n24\n\nWe have to make a decision. \nHow do we divide these?","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":24,"lines":{"from":1,"to":6}}}},{"pageContent":"Sort the points by p (logistic output)\n\n25\n\nWe have to make a decision. \nHow do we divide these?\n\nno false negatives","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":25,"lines":{"from":1,"to":8}}}},{"pageContent":"Sort the points by p (logistic output)\n\n26\n\nWe have to make a decision. \nHow do we divide these?\n\nno false positives","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":26,"lines":{"from":1,"to":8}}}},{"pageContent":"Sort the points by p (logistic output)\n\n27\n\nWe have to make a decision. \nHow do we divide these?\n\nmore balanced?","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":27,"lines":{"from":1,"to":8}}}},{"pageContent":"What do we do with p?\n\n28\n\n●\nYou need to convert a \nprobability\n \n(probability that y=1) to a \nbinary\n output \n\n(y = either 1 or 0)\n\n\n●\nIf I tell you the probability of y=1 is 100%, \nwhat would you say that y = ?","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":28,"lines":{"from":1,"to":18}}}},{"pageContent":"29\n\n●\nYou need to convert a \nprobability\n \n(probability that y=1) to a \nbinary\n output \n\n(y = either 1 or 0)\n\n\n●\nIf I tell you the probability of y=1 is 100%, \nwhat would you say that y = ? (\n1\n)\n\nWhat do we do with p?","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":29,"lines":{"from":1,"to":20}}}},{"pageContent":"30\n\n●\nYou need to convert a \nprobability\n \n(probability that y=1) to a \nbinary\n output \n\n(y = either 1 or 0)\n\n\n●\nIf I tell you the probability of y=1 is \n90%\n, \nwhat would you say that y = ?\n\nWhat do we do with p?","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":30,"lines":{"from":1,"to":20}}}},{"pageContent":"31\n\n●\nYou need to convert a \nprobability\n \n(probability that y=1) to a \nbinary\n output \n\n(y = either 1 or 0)\n\n\n●\nIf I tell you the probability of y=1 is 90%, \nwhat would you say that y = ? (\n1\n)\n\nWhat do we do with p?","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":31,"lines":{"from":1,"to":20}}}},{"pageContent":"32\n\n●\nYou need to convert a \nprobability\n \n(probability that y=1) to a \nbinary\n output \n\n(y = either 1 or 0)\n\n\n●\nIf I tell you the probability of y=1 is 90%, \nwhat would you say that y = ?\n\n○\nWhat if the probability is 80, or 75, or \n55, or 52, or 51, or 50.000001?\n\nWhat do we do with p?","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":32,"lines":{"from":1,"to":22}}}},{"pageContent":"Binarizing threshold\n\n33\n\n●\nUsually, you set a threshold of 50% to \nbinarize a probability:\n\n\n○\nIf you think there are better than 50/50 \nodds that y=1, then when choosing \nbetween outputting y=1 and y=0, you \nshould choose y=1","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":33,"lines":{"from":1,"to":14}}}},{"pageContent":"Binarizing threshold\n\n34\n\n●\nWhat if we don’t choose 50% as a \nthreshold?\n\nImage\n\n \nŷ Probability\n\n50% Threshold\n\n40% Threshold\n\nDog (1)\n\n0.9\n\n1\n\n1\n\nDog (1)\n\n0.4\n\n0\n\n1\n\nCat (0)\n\n0.3\n\n0\n\n0","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":34,"lines":{"from":1,"to":40}}}},{"pageContent":"Changing thresholds\n\n35\n\n●\nChanging thresholds can let you change \nyour precision and recall (possibly \nimproving your metrics)\n\n\n●\nWe can use thresholds to show something \nabout the relationship between precision \nand recall","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":35,"lines":{"from":1,"to":14}}}},{"pageContent":"Earlier: fn decrease \n→\n recall increase\n\n●\nRecall\n \n= tp / (tp + fn)\n\n●\np = tp+fn\n\n●\nRecall = (p - fn) / (p)\n\n                = 1 - (fn/p)\n\n●\nIf fn decreases, (fn/p) decreases since p is constant\n\n●\n...so, recall [1-(fn/p)] \nalways increases\n\n36\n\ntp\n\nfn\n\nfp\n\ntn\n\n   \nŷ\n=1      \nŷ\n=0\n\n y=0     y=1","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":36,"lines":{"from":1,"to":41}}}},{"pageContent":"●\nPrecision = tp / (tp + fp)\n\n\n●\nIf we change thresholds and decrease the \nnumber of false negatives produced by our \nmodel, what happens to precision? \n \n\nfn decrease \n→\n precision change?\n\n37\n\ntp\n\nfn\n\nfp\n\ntn\n\n   \nŷ\n=1      \nŷ\n=0\n\n y=0     y=1\n\ny (0 or 1)\n\nŷ (probability)\n\nThreshold 1\n\nThreshold 2\n\n...\n\n...\n\n...\n\n...","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":37,"lines":{"from":1,"to":47}}}},{"pageContent":"Decreasing fn can decrease \nprecision = tp/(tp+fp)\n\n38\n\nImage\n\n \nŷ Probability\n\n50% Threshold \n\n\nDog (1)\n\n0.8\n\n1\n\nDog (1)\n\n0.2\n\n0\n\nCat (0)\n\n0.2\n\n0\n\nCat (0)\n\n0.2\n\n0\n\nhttps://datascience.stackexchange.com/questions/49117/inverse-relationship-between-precision-and-recall","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":38,"lines":{"from":1,"to":38}}}},{"pageContent":"Decreasing fn can decrease \nprecision = tp/(tp+fp)\n\n39\n\nImage\n\n \nŷ Probability\n\n50% Threshold \n\n(1 false negative)\n\nDog (1)\n\n0.8\n\n1\n\nDog (1)\n\n0.2\n\n0\n\nCat (0)\n\n0.2\n\n0\n\nCat (0)\n\n0.2\n\n0\n\nhttps://datascience.stackexchange.com/questions/49117/inverse-relationship-between-precision-and-recall","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":39,"lines":{"from":1,"to":39}}}},{"pageContent":"Decreasing fn can decrease \nprecision = tp/(tp+fp)\n\n40\n\nImage\n\n \nŷ Probability\n\n50% Threshold \n\n(1 false negative)\n\nDog (1)\n\n0.8\n\n1\n\nDog (1)\n\n0.2\n\n0\n\nCat (0)\n\n0.2\n\n0\n\nCat (0)\n\n0.2\n\n0\n\nPrecision = 1 / (1+0) = 1\n\nhttps://datascience.stackexchange.com/questions/49117/inverse-relationship-between-precision-and-recall\n \n\ntp\n\nfn\n\nfp\n\ntn\n\n   \nŷ\n=1      \nŷ\n=0\n\n y=0     y=1\n\nThere are 0 false \npositives (cats \npredicted as dogs)","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":40,"lines":{"from":1,"to":62}}}},{"pageContent":"41\n\nImage\n\n \nŷ Probability\n\n50% Threshold \n\n(1 false negative)\n\n0% Threshold \n\n(0 false negatives)\n\nDog (1)\n\n0.8\n\n1\n\n?\n\nDog (1)\n\n0.2\n\n0\n\n?\n\nCat (0)\n\n0.2\n\n0\n\n?\n\nCat (0)\n\n0.2\n\n0\n\n?\n\nPrecision = 1 / (1+0) = 1\n\nhttps://datascience.stackexchange.com/questions/49117/inverse-relationship-between-precision-and-recall\n \n\nPrecision = ?\n\n琀\n琀\n \n\nDecreasing fn can decrease \nprecision = tp/(tp+fp)\n\ntp\n\nfn\n\nfp\n\ntn\n\n   \nŷ\n=1      \nŷ\n=0\n\n y=0     y=1","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":41,"lines":{"from":1,"to":76}}}},{"pageContent":"42\n\nImage\n\n \nŷ Probability\n\n50% Threshold \n\n(1 false negative)\n\n0% Threshold \n\n(0 false negatives)\n\nDog (1)\n\n0.8\n\n1\n\n1\n\nDog (1)\n\n0.2\n\n0\n\n1\n\nCat (0)\n\n0.2\n\n0\n\n1\n\nCat (0)\n\n0.2\n\n0\n\n1\n\nPrecision = 1 / (1+0) = 1\n\nhttps://datascience.stackexchange.com/questions/49117/inverse-relationship-between-precision-and-recall\n \n\nDecreasing fn can decrease \nprecision = tp/(tp+fp)\n\nAny probability > threshold = 1\n\nAll probabilities > 0 \n→\n Everything = 1!","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":42,"lines":{"from":1,"to":60}}}},{"pageContent":"43\n\nImage\n\n \nŷ Probability\n\n50% Threshold \n\n(1 false negative)\n\n0% Threshold \n\n(0 false negatives)\n\nDog (1)\n\n0.8\n\n1\n\n1\n\nDog (1)\n\n0.2\n\n0\n\n1\n\nCat (0)\n\n0.2\n\n0\n\n1\n\nCat (0)\n\n0.2\n\n0\n\n1\n\nPrecision = 1 / (1+0) = 1\n\nPrecision = 2 / (2+2) = 0.5\n\nhttps://datascience.stackexchange.com/questions/49117/inverse-relationship-between-precision-and-recall\n \n\nDecreasing fn can decrease \nprecision = tp/(tp+fp)\n\ntp\n\nfn\n\nfp\n\ntn\n\n   \nŷ\n=1      \nŷ\n=0\n\n y=0     y=1","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":43,"lines":{"from":1,"to":72}}}},{"pageContent":"44\n\nImage\n\n \nŷ Probability\n\n50% Threshold \n\n(1 false negative)\n\n0% Threshold \n\n(0 false negatives)\n\nDog (1)\n\n0.8\n\n1\n\n1\n\nDog (1)\n\n0.2\n\n0\n\n1\n\nCat (0)\n\n0.2\n\n0\n\n1\n\nCat (0)\n\n0.2\n\n0\n\n1\n\nPrecision = 1 / (1+0) = 1\n\nPrecision = 2 / (2+2) = 0.5\n\nhttps://datascience.stackexchange.com/questions/49117/inverse-relationship-between-precision-and-recall\n \n\nDecreasing\n fn can \ndecrease\n \nprecision = tp/(tp+fp)","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":44,"lines":{"from":1,"to":59}}}},{"pageContent":"But decreasing fn can also \nincrease\n precision = tp/(tp+fp)\n\n45\n\nImage\n\n \nŷ Probability\n\n50% Threshold \n\n(1 false negative)\n\n0% Threshold \n\n(0 false negatives)\n\nCat (0)\n\n1.0\n\n1\n\n?\n\nDog (1)\n\n0.4\n\n0\n\n?\n\nCat (0)\n\n0.1\n\n0\n\n?\n\nhttps://datascience.stackexchange.com/questions/49117/inverse-relationship-between-precision-and-recall\n \n\nPrecision = 0 / (0+1) = 0\n\n琀\n琀\n \n\nPrecision = ?","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":45,"lines":{"from":1,"to":53}}}},{"pageContent":"46\n\nImage\n\n \nŷ Probability\n\n50% Threshold \n\n(1 false negative)\n\n0% Threshold \n\n(0 false negatives)\n\nCat (0)\n\n1.0\n\n1\n\n1\n\nDog (1)\n\n0.4\n\n0\n\n1\n\nCat (0)\n\n0.1\n\n0\n\n1\n\nhttps://datascience.stackexchange.com/questions/49117/inverse-relationship-between-precision-and-recall\n \n\nPrecision = 0 / (0+1) = 0\n\nPrecision = 1 / (1+2) = 1/3\n\nBut decreasing fn can also \nincrease precision = tp/(tp+fp)\n\ntp\n\nfn\n\nfp\n\ntn\n\n   \nŷ\n=1      \nŷ\n=0\n\n y=0     y=1","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":46,"lines":{"from":1,"to":64}}}},{"pageContent":"Changing thresholds\n\n47\n\ntp\n\nfn\n\nfp\n\ntn\n\n   \nŷ\n=1        \nŷ\n=0\n\n  y=0         y=1\n\nDecreasing the \nthreshold (e.g. from \n50% to 0%) can shift \nyour false negatives \nand your true negatives \ntowards positives","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":47,"lines":{"from":1,"to":26}}}},{"pageContent":"Changing thresholds\n\n48\n\ntp\n\nfn\n\nfp\n\ntn\n\n   \nŷ\n=1        \nŷ\n=0\n\n  y=0         y=1\n\nIncreasing the \nthreshold (e.g. from 0% \nto 50%) can shift your \nfalse positives and your \ntrue positives towards \nnegatives","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":48,"lines":{"from":1,"to":26}}}},{"pageContent":"●\nIf we change the threshold to decrease \nthe number of false negatives ...\n\n\n○\nRecall necessarily increases\n\n\n○\nPrecision could increase or decrease\n\n\n\nPrecision and Recall Recap\n\n49\n\ntp\n\nfn\n\nfp\n\ntn\n\n   \nŷ\n=1      \nŷ\n=0\n\n y=0     y=1","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":49,"lines":{"from":1,"to":33}}}},{"pageContent":"Admin\n\n●\nPhase 2 due this Thursday at 11:59 p.m. \n\n○\nNo slip days are allowed for project deadlines\n\n\n●\nPrelim regrade requests must be made in \nGradescope by the end of October\n\n\n●\nIf project groups need to change after drop \ndeadline, post on Ed to find a group / new members\n\n50","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":50,"lines":{"from":1,"to":19}}}},{"pageContent":"A classification model separates email into \ntwo categories: \"spam\" or \"not spam.\" If you \nraise the classification threshold, what will \nhappen to precision? \n[Precision = tp / (tp+fp)]\n\n51\n\nhttps://developers.google.com/machine-learning/crash-course/classification/check-your-understanding-accuracy-precision-recall\n \n\n1.\nProbably Decrease\n\n2.\nDefinitely Decrease\n\n3.\nProbably Increase\n\n4.\nDefinitely Increase\n\n琀\n琀\n \n\nINTERVIEW QUESTION!","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":51,"lines":{"from":1,"to":28}}}},{"pageContent":"A classification model separates email into \ntwo categories: \"spam\" or \"not spam.\" If you \nraise the classification threshold, what will \nhappen to precision? \n\n52\n\nhttps://developers.google.com/machine-learning/crash-course/classification/check-your-understanding-accuracy-precision-recall\n \n\n1.\nProbably Decrease\n\n2.\nDefinitely Decrease\n\n3.\nProbably Increase\n\n4.\nDefinitely Increase\n\n“In general, raising \nthe classification \nthreshold reduces \nfalse positives, thus \nraising precision.”\n\nINTERVIEW QUESTION!","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":52,"lines":{"from":1,"to":29}}}},{"pageContent":"A classification model separates email into \ntwo categories: \"spam\" or \"not spam.\" If you \nraise the classification threshold, what will \nhappen to recall? \n[Recall = tp / (tp + fn)]\n\n53\n\nhttps://developers.google.com/machine-learning/crash-course/classification/check-your-understanding-accuracy-precision-recall\n \n\n1.\nAlways increase\n\n2.\nAlways stay constant\n\n3.\nAlways decrease or stay the same\n\n琀\n琀\n \n\nINTERVIEW QUESTION!","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":53,"lines":{"from":1,"to":25}}}},{"pageContent":"A classification model separates email into \ntwo categories: \"spam\" or \"not spam.\" If you \nraise the classification threshold, what will \nhappen to recall? \n\n54\n\nhttps://developers.google.com/machine-learning/crash-course/classification/check-your-understanding-accuracy-precision-recall\n \n\n1.\nAlways increase\n\n2.\nAlways stay constant\n\n3.\nAlways decrease or stay the same\n\n“Raising our classification threshold will cause the number of true positives to \ndecrease or stay the same and will cause the number of false negatives to \nincrease or stay the same. Thus, recall will either stay constant or decrease.”\n\nINTERVIEW QUESTION!","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":54,"lines":{"from":1,"to":24}}}},{"pageContent":"55\n\n●\nWhat can we say about the \nrelationship between recall \nand precision, both of which \nwe want to be high?\n\nhttps://creatronix.de/classification-precision-and-recall/","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":55,"lines":{"from":1,"to":9}}}},{"pageContent":"What if we consider a lot of \nthresholds all at once?\n\nhttps://developers.google.com/machine-learning/crash-course/classification/roc-and-auc\n \n\n56","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":56,"lines":{"from":1,"to":7}}}},{"pageContent":"Precision Recall Curves\n\n57\n\nhttps://machinelearningmastery.com/threshold-moving-for-imbalanced-classification/","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":57,"lines":{"from":1,"to":5}}}},{"pageContent":"Precision Recall Curves\n\n58\n\nIn general, for a model \nbetter than random, \nrecall and precision have \nan inverse relationship\n\n\nhttps://machinelearningmastery.com/threshold-moving-for-imbalanced-classification/","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":58,"lines":{"from":1,"to":11}}}},{"pageContent":"Precision Recall Curves\n\n59\n\nYou can plot PR curves to \nhelp you think about \nwhat threshold is “Best” \n(giving you ideal \nachievable recall and \nprecision)\n\nhttps://machinelearningmastery.com/threshold-moving-for-imbalanced-classification/","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":59,"lines":{"from":1,"to":12}}}},{"pageContent":"●\nF\n1\n score: \n\n\n●\nThis is the \nharmonic mean\n of precision and \nrecall\n\n\n●\nHigher F\n1\n is better\n\n60\n\nF1 combines precision and recall","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":60,"lines":{"from":1,"to":21}}}},{"pageContent":"https://en.wikipedia.org/wiki/Sensitivity_and_specificity\n \n\n(Lots of options for classification)\n\n61","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":61,"lines":{"from":1,"to":6}}}},{"pageContent":"F1 score\n\n62\n\nhttps://machinelearningmastery.com/threshold-moving-for-imbalanced-classification/\n \n\nThis is the point that \nmaximizes the F\n1\n score \n(harmonic mean of \nprecision and recall)","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":62,"lines":{"from":1,"to":13}}}},{"pageContent":"●\nF\n1\n score: \n\n\n●\nAUC-ROC curve\n: fp / (tn + fp) \na.k.a. specificity\n \nversus recall\n\n\n●\nHigher F\n1\n and AUC is better\n\n63\n\nBinary evaluation metrics, part 2","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":63,"lines":{"from":1,"to":22}}}},{"pageContent":"Another curve: ROC\n\n64\n\nhttps://towardsdatascience.com/understanding-auc-roc-curve-68b2303cc9c5\n \n\n●\nReceiver Operating Characteristic\n (ROC) \nplots the FPR vs. TPR\n\n○\nOriginally developed for military radar \npurposes\n\n\n\nhttps://res.cloudinary.com/engineering-com/imag\ne/fetch/w_450,f_jpg,c_fill/http://image.engineering\n.com/239575/articles/jan2015/ti12/ti12-1.PNG","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":64,"lines":{"from":1,"to":21}}}},{"pageContent":"What is ROC?\n\n65\n\nhttps://towardsdatascience.com/understanding-auc-roc-curve-68b2303cc9c5\n \n\n●\nReceiver Operating Characteristic\n (ROC) \nplots the FPR vs. TPR\n\n○\nOriginally developed for military radar \npurposes\n\n\n●\nFalse Positive Rate\n (a.k.a. 1-specificity)\n\n○\nfp / (fp + tn) \n\n\n●\nTrue Positive Rate\n (a.k.a. recall, sensitivity)\n\n○\ntp / (tp + fn)\n\n\nhttps://res.cloudinary.com/engineering-com/imag\ne/fetch/w_450,f_jpg,c_fill/http://image.engineering\n.com/239575/articles/jan2015/ti12/ti12-1.PNG","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":65,"lines":{"from":1,"to":36}}}},{"pageContent":"https://en.wikipedia.org/wiki/Sensitivity_and_specificity\n \n\n(Lots of options for classification)\n\n66","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":66,"lines":{"from":1,"to":6}}}},{"pageContent":"Perfectly separated data \n→\n \nperfect ROC curve\n\n67\n\nhttps://towardsdatascience.com/understanding-auc-roc-curve-68b2303cc9c5","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":67,"lines":{"from":1,"to":8}}}},{"pageContent":"Perfectly separated data \n→\n \nperfect ROC curve\n\n68\n\nhttps://towardsdatascience.com/understanding-auc-roc-curve-68b2303cc9c5","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":68,"lines":{"from":1,"to":8}}}},{"pageContent":"Perfectly separated data \n→\n \nperfect ROC curve\n\n69\n\nhttps://towardsdatascience.com/understanding-auc-roc-curve-68b2303cc9c5","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":69,"lines":{"from":1,"to":8}}}},{"pageContent":"Slightly overlapping data \n→\n \nslightly lower ROC curve\n\n70\n\nhttps://towardsdatascience.com/understanding-auc-roc-curve-68b2303cc9c5","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":70,"lines":{"from":1,"to":8}}}},{"pageContent":"Exactly overlapping data \n→\n diagonal \nROC curve (as good as random)\n\n71\n\nhttps://towardsdatascience.com/understanding-auc-roc-curve-68b2303cc9c5","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":71,"lines":{"from":1,"to":8}}}},{"pageContent":"Perfectly flipped data \n→\n worst \nROC curve \n\n72\n\nhttps://towardsdatascience.com/understanding-auc-roc-curve-68b2303cc9c5","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":72,"lines":{"from":1,"to":8}}}},{"pageContent":"Good vs. Bad ROC\n\n73\n\nhttps://commons.wikimedia.org/wiki/File:Roc-draft-xkcd-style.svg","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":73,"lines":{"from":1,"to":5}}}},{"pageContent":"ROC curve     \n→\n           AUC\n\nhttps://developers.google.com/machine-learning/crash-course/classification/roc-and-auc\n \n\n74","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":74,"lines":{"from":1,"to":8}}}},{"pageContent":"AUC interpretation\n\n-\nAbility of your classifier to distinguish \nbetween two classes\n\n-\nSummarizes the ROC curve\n\nhttps://developers.google.com/machine-learning/crash-course/classification/roc-and-auc\n \n\n75","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":75,"lines":{"from":1,"to":13}}}},{"pageContent":"AUC interpretation\n\nProbability that your logit model ranks a \nrandom positive example more highly than a \nrandom negative example\n\n\nhttps://developers.google.com/machine-learning/crash-course/classification/roc-and-auc\n \n\n76","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":76,"lines":{"from":1,"to":11}}}},{"pageContent":"Classification prediction metrics in Python\n\n●\nfrom sklearn.metrics import precision_score, \nrecall_score, f1_score, roc_auc_score\n\n\n●\nprecision_score(y_true,y_hat)\n\n●\nrecall_score(y_true,y_hat)\n\n●\nf1_score(y_true,y_hat)\n\n●\nroc_auc_score(y_true,y_hat)\n\n77","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":77,"lines":{"from":1,"to":20}}}},{"pageContent":"78\n\nNomenclature for these slides\n\nGeneral case\n\n“y_true”,  “y\ni\n”\n\n“y_hat”, “ŷ\ni\n”\n\nTrain set\n\ny_train\n\ny_hat_train\n\nTest set\n\ny_test\n\ny_hat_test\n\nWhen providing \nformulas in these \nslides, we’ll \ngeneralize to these","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":78,"lines":{"from":1,"to":30}}}},{"pageContent":"Classification prediction metrics in Python\n\n●\nfrom sklearn.metrics import precision_score, \nrecall_score, f1_score, roc_auc_score\n\n\n●\nprecision_score(\ny_true,y_hat\n)\n\n●\nrecall_score(\ny_true,y_hat\n)\n\n●\nf1_score(\ny_true,y_hat\n)\n\n●\nroc_auc_score(\ny_true,y_hat\n)\n\n79","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":79,"lines":{"from":1,"to":28}}}},{"pageContent":"Check the Scikit Learn documentation!\n\n80\n\nhttps://scikit-learn.org/stable/modules/model_evaluation.html","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":80,"lines":{"from":1,"to":5}}}},{"pageContent":"1 minute break & attendance\n\n81\n\ntinyurl.com/ykv3f9a9","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":81,"lines":{"from":1,"to":5}}}},{"pageContent":"82","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":82,"lines":{"from":1,"to":1}}}},{"pageContent":"83\n\nMotivation\n\n?\n\n●\nHow confident can we be that the \npatterns in the things we \nhave\n \nseen will apply to the things we \nhaven't \nseen?","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":83,"lines":{"from":1,"to":14}}}},{"pageContent":"●\nHow confident can we be that the \npatterns in the things we \nhave\n \nseen will apply to the things we \nhaven't \nseen?\n\n\n●\nKey insight: pretend we \nhaven't\n \nseen some of the things we \nhave\n \nseen, and check if we would have \nguessed correctly\n\n84\n\nMotivation\n\n?","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":84,"lines":{"from":1,"to":25}}}},{"pageContent":"85","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":85,"lines":{"from":1,"to":1}}}},{"pageContent":"What could go wrong with \ntrain/test?\n\n●\nTrain set proportion too big (test set not broad enough)\n\n\n\n86","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":86,"lines":{"from":1,"to":9}}}},{"pageContent":"What could go wrong with \ntrain/test?\n\n●\nTrain set proportion too big (test set not broad enough)\n\n\n●\nTest set proportion too big (not enough training data)\n\n\n\n87","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":87,"lines":{"from":1,"to":13}}}},{"pageContent":"What could go wrong with \ntrain/test?\n\n●\nTrain set proportion too big (test set not broad enough)\n\n\n●\nTest set proportion too big (not enough training data)\n\n\n●\nTest set data too similar/dissimilar to train set data \n(overestimating/underestimating generalization)\n\n\n\n88","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":88,"lines":{"from":1,"to":18}}}},{"pageContent":"What could go wrong with \ntrain/test?\n\n●\nTrain set proportion too big (test set not broad enough)\n\n\n●\nTest set proportion too big (not enough training data)\n\n\n●\nTest set data too similar/dissimilar to train set data \n(overestimating/underestimating generalization)\n\n\n\n89\n\nIf your train set is \nonly side sleepers and \nyour test set is only \nback sleepers, no \nmatter how you \nchange your model, \nyou still won’t get \ngood evaluations and \nwill overfit to side \nsleepers!","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":89,"lines":{"from":1,"to":29}}}},{"pageContent":"What could go wrong with \ntrain/test?\n\n●\nTrain set proportion too big (test set not broad enough)\n\n\n●\nTest set proportion too big (not enough training data)\n\n\n●\nTest set data too similar/dissimilar to train set data \n(overestimating/underestimating generalization)\n\n\n\n90\n\nIf your original set is \nonly US undergrads, \nno amount of splitting \nwill test \ngeneralization to \nmiddle-aged Brazilian \nmanufacturing \nworkers","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":90,"lines":{"from":1,"to":27}}}},{"pageContent":"What could go wrong with \ntrain/test?\n\n●\nTrain set proportion too big (test set not broad enough)\n\n\n●\nTest set proportion too big (not enough training data)\n\n\n●\nTest set data too similar/dissimilar to train set data \n(overestimating/underestimating generalization)\n\n\n●\nHaving ordered rows in a df (shouldn’t randomize x-axis \norder of time series)\n\n91","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":91,"lines":{"from":1,"to":21}}}},{"pageContent":"What could go wrong with \ntrain/test?\n\n●\nTrain set proportion too big (test set not broad enough)\n\n\n●\nTest set proportion too big (not enough training data)\n\n\n●\nTest set data too similar/dissimilar to train set data \n(overestimating/underestimating generalization)\n\n\n●\nHaving ordered rows in a df (shouldn’t randomize x-axis \norder of time series)\n\n92\n\nIf you split your time \nseries data randomly \ninto train and test \ndata, you’ll have time \nseries with a bunch of \nrandom missing days. \nMissing chronological \ndata is bad!","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":92,"lines":{"from":1,"to":30}}}},{"pageContent":"What could go wrong with \ntrain/test?\n\n●\nTrain set proportion too big (test set not broad enough)\n\n\n●\nTest set proportion too big (not enough training data)\n\n\n●\nTest set data too similar/dissimilar to train set data \n(overestimating/underestimating generalization)\n\n\n●\nHaving ordered rows in a df (shouldn’t randomize x-axis \norder of time series)\n\n93\n\nSolution: \nCross-Validation","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":93,"lines":{"from":1,"to":24}}}},{"pageContent":"What could go wrong with \ntrain/test?\n\n●\nTrain set proportion too big (test set not broad enough)\n\n\n●\nTest set proportion too big (not enough training data)\n\n\n●\nTest set data too similar/dissimilar to train set data \n(overestimating/underestimating generalization)\n\n\n●\nHaving ordered rows in a df (shouldn’t randomize x-axis \norder of time series)\n\n94\n\nSolution: \n\nSliding Windows","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":94,"lines":{"from":1,"to":25}}}},{"pageContent":"95","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":95,"lines":{"from":1,"to":1}}}},{"pageContent":"96","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":96,"lines":{"from":1,"to":1}}}},{"pageContent":"Validation Sets\n\n●\nWe know we can split data into train / test sets\n\n\n●\nBut there are a lot of reasons this may not be \nreliable\n\n\n●\nWhat if we do the train / test splitting process \nagain\n with the training set?\n\n97","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":97,"lines":{"from":1,"to":17}}}},{"pageContent":"We have lots of choices of \nprediction models\n\n98\n\n●\nWhich variables should we include as  inputs?\n\n●\nShould we use transformations?\n\n●\nShould we filter training data?\n\n●\nShould we use more complicated models? Interactions?","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":98,"lines":{"from":1,"to":16}}}},{"pageContent":"We have lots of choices of \nprediction models\n\n99\n\n●\nWhich variables should we include as  inputs?\n\n●\nShould we use transformations?\n\n●\nShould we filter training data?\n\n●\nShould we use more complicated models? Interactions?\n\nDanger: The more models we try, the more chances to get good results by pure luck","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":99,"lines":{"from":1,"to":18}}}},{"pageContent":"The more tries \nyou take, the \nmore likely \nyou’ll get good \neval metrics\n\n100\n\nhttps://en.wikipedia.org/wiki/Darts","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":100,"lines":{"from":1,"to":9}}}},{"pageContent":"Validation Sets\n\n101\n\n●\nDon’t want to cheat by overusing your test set\n\n\n●\nYou can only use your test set so many times before \nit’s \nno longer useful to discover overfitting (since you’ll \nstart fitting to your test set too)\n\n\n●\nUse validation set to check your evaluation metrics \nbefore checking your “final” test set","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":101,"lines":{"from":1,"to":18}}}},{"pageContent":"102\n\nhttps://algotrading101.com/learn/train-test-split/","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":102,"lines":{"from":1,"to":3}}}},{"pageContent":"103\n\nhttps://algotrading101.com/learn/train-test-split/","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":103,"lines":{"from":1,"to":3}}}},{"pageContent":"Sub-split training to get validation\n\n104\n\nfrom sklearn.model_selection import train_test_split\n\nX_train, X_test, y_train, y_test =\n\ntrain_test_split(X, y, test_size = 0.3)\n\n\nhttps://builtin.com/data-science/train-test-split","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":104,"lines":{"from":1,"to":12}}}},{"pageContent":"Sub-split training to get validation\n\n105\n\nfrom sklearn.model_selection import train_test_split\n\nX_train, X_test, y_train, y_test =\n\ntrain_test_split(X, y, test_size = 0.3)\n\nX_train, X_valid, y_train, y_valid =\n\ntrain_test_split(X_train, y_train, test_size = 0.1)","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":105,"lines":{"from":1,"to":13}}}},{"pageContent":"Sub-split training to get validation\n\n106\n\nfrom sklearn.model_selection import train_test_split\n\nX_train, X_test, y_train, y_test =\n\ntrain_test_split(X, y, test_size = 0.3)\n\nX_train, X_valid, y_train, y_valid =\n\ntrain_test_split(X_train, y_train, test_size = 0.1)","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":106,"lines":{"from":1,"to":13}}}},{"pageContent":"107\n\nfrom sklearn.model_selection import train_test_split\n\nX_train, X_test, y_train, y_test =\n\ntrain_test_split(X, y, test_size = 0.3)\n\nX_train, X_valid, y_train, y_valid =\n\ntrain_test_split(X_train, y_train, test_size = 0.1)\n\nWhat % of the overall dataset are your train / valid / test sets?\n\n琀\n琀\n \n\nSub-split training to get validation\n\n70/30 train/test \nsplit in first step\n\n?","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":107,"lines":{"from":1,"to":24}}}},{"pageContent":"Sub-split training to get validation\n\n108\n\nfrom sklearn.model_selection import train_test_split\n\nX_train, X_test, y_train, y_test =\n\ntrain_test_split(X, y, test_size = 0.3)\n\nX_train, X_valid, y_train, y_valid =\n\ntrain_test_split(X_train, y_train, test_size = 0.1)\n\n63/7/30\n  train/val/test split in second step (since the 70% train set gets \nsplit into 70*90% \n→\n train and 70*10% \n→\n validation)","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":108,"lines":{"from":1,"to":21}}}},{"pageContent":"109\n\nhttps://algotrading101.com/learn/train-test-split/\n \n\nOne Validation Set","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":109,"lines":{"from":1,"to":6}}}},{"pageContent":"Cross\n Validation\n\n110\n\nhttps://scikit-learn.org/stable/modules/cross_validation.html\n \n\nNew train sets & \nvalidation sets\n\n          “Final” Test","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":110,"lines":{"from":1,"to":12}}}},{"pageContent":"Cross Validation\n\n111\n\nhttps://scikit-learn.org/stable/modules/cross_validation.html\n \n\nFor each split, fit \nthe model on \n“training data” (\n⅘\n \nfolds) and calculate \nevaluation metric \non the “validation \ndata” (\n⅕\n fold)\n\n          “Final” Test","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":111,"lines":{"from":1,"to":20}}}},{"pageContent":"Cross Validation\n\n112\n\nhttps://scikit-learn.org/stable/modules/cross_validation.html\n \n\n\n\nFit model 5 times, \nget 5 different \nvalidation set \nevaluation metrics\n\n          “Final” Test","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":112,"lines":{"from":1,"to":15}}}},{"pageContent":"Cross Validation\n\n113\n\nhttps://scikit-learn.org/stable/modules/cross_validation.html\n \n\n\n\nCalculate avg and \nstdev of 5 metrics \nto understand \nwhether you’re \noverfitting\n\n          “Final” Test","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":113,"lines":{"from":1,"to":16}}}},{"pageContent":"Cross Validation\n\n114\n\nhttps://scikit-learn.org/stable/modules/cross_validation.html\n \n\nOnly move to “final” \ntest set metric \ncalculation once \ncertain you’re not \noverfitting\n\n          “Final” Test","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":114,"lines":{"from":1,"to":14}}}},{"pageContent":"Why CV?\n\n●\nAvoids pitfalls discussed earlier (getting lucky \nwith one test set)\n\n\n●\nAllows you to update your model without \noverfitting to a specific set of data\n\n\n●\nUsing CV with 5 folds \n→\n 5 values of an evaluation \nmetric.  Use summary stats to understand model \nperformance \nacross different data samples\n\n115","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":115,"lines":{"from":1,"to":21}}}},{"pageContent":"Options for cross-validation\n\n●\nPartitions or independent \nrandom splits\n\n\n●\nNumber of splits\n\n\n●\nSpecial case: leave-one-out \n(LOO) cross-validation\n\n\n\n116\n\nhttps://scikit-learn.org/stable/modules/cross_validation.html","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":116,"lines":{"from":1,"to":20}}}},{"pageContent":"117\n\nhttps://dataaspirant.com/7-loocv-leave-one-out-cross-validation/","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":117,"lines":{"from":1,"to":3}}}},{"pageContent":"Cross Validation Variance\n\n●\nIf you increase the number of splits during \ncross-validation, does the \nvariance \nor your \nestimated evaluation metric (the average of \nmetrics across splits) tend to \nincrease or \ndecrease\n?\n\n\n118\n\nhttps://scikit-learn.org/stable/modules/cross_validation.html\n | \nhttps://dataaspirant.com/7-loocv-leave-one-out-cross-validation/\n \n\n \n\n琀\n琀","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":118,"lines":{"from":1,"to":25}}}},{"pageContent":"Cross Validation Variance\n\n\n●\nIf you increase the number of splits during \ncross-validation, does the \nvariance \nor your \nestimated evaluation metric (the average of \nmetrics across splits) increase or decrease?\n\n\n●\nGenerally, having more metrics to average (e.g. 1 \nper data point in the LOO case) \n→\n more likely to get \noutliers \n→\n \nvariance increases\n\n\n119\n\nhttps://scikit-learn.org/stable/modules/cross_validation.html\n | \nhttps://dataaspirant.com/7-loocv-leave-one-out-cross-validation/","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":119,"lines":{"from":1,"to":28}}}},{"pageContent":"How to generate cross-validation splits\n\n120\n\nfrom sklearn.model_selection import train_test_split\n\nX_train, X_test, y_train, y_test =\n\ntrain_test_split(X, y, test_size = 0.3)\n\nfor f in folds:\n\nX_train[f], X_valid[f], y_train[f], y_valid[f] =\n\n  train_test_split(X_train, y_train, test_size = 0.1)","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":120,"lines":{"from":1,"to":15}}}},{"pageContent":"How to generate cross-validation splits\n\n121\n\nfrom sklearn.model_selection import train_test_split\n\nX_train, X_test, y_train, y_test =\n\ntrain_test_split(X, y, test_size = 0.3)\n\nfor f in folds:\n\nX_train[f], X_valid[f], y_train[f], y_valid[f] =\n\n  train_test_split(X_train, y_train, test_size = 0.1)\n\nshould  I use a fixed random seed here?\n\n琀\n琀","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":121,"lines":{"from":1,"to":20}}}},{"pageContent":"How to generate cross-validation splits\n\n122\n\nfrom sklearn.model_selection import train_test_split\n\nX_train, X_test, y_train, y_test =\n\ntrain_test_split(X, y, test_size = 0.3)\n\nfor f in folds:\n\nX_train[f], X_valid[f], y_train[f], y_valid[f] =\n\n  train_test_split(X_train, y_train, test_size = 0.1)\n\nNo! That would just give me the same split \nfolds\n times","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":122,"lines":{"from":1,"to":19}}}},{"pageContent":"123\n\nhttps://m.facebook.com/convolutionalmemes/posts/788912368229932","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":123,"lines":{"from":1,"to":3}}}},{"pageContent":"How to generate cross-validation splits\n\n124\n\nfrom sklearn.model_selection import KFold\n\n\nkf = KFold(n_splits=2)\n\n\n\nNew package\n\nhttps://scikit-learn.org/stable/modules/cross_validation.html","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":124,"lines":{"from":1,"to":14}}}},{"pageContent":"How to generate cross-validation splits\n\n125\n\nfrom sklearn.model_selection import KFold\n\n\nkf = KFold(n_splits=2)\n\n\n\nDefine how many \nsplits to use\n\nhttps://scikit-learn.org/stable/modules/cross_validation.html","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":125,"lines":{"from":1,"to":15}}}},{"pageContent":"How to generate cross-validation splits\n\n126\n\nfrom sklearn.model_selection import KFold\n\nX = [\"a\", \"b\", \"c\", \"d\"]\n\nkf = KFold(n_splits=2)\n\n\n\n\n\n\nDefining some \nsample data (think \nof this as a column \nof input data in the \ntraining set)\n\nhttps://scikit-learn.org/stable/modules/cross_validation.html","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":126,"lines":{"from":1,"to":22}}}},{"pageContent":"How to generate cross-validation splits\n\n127\n\nfrom sklearn.model_selection import KFold\n\nX = [\"a\", \"b\", \"c\", \"d\"]\n\nkf = KFold(n_splits=2)\n\nfor train, test in kf.split(X):\n\n   print(f\"{train} {test}\")\n\n\n\n\n\nSplit the input \ndata X\n\nhttps://scikit-learn.org/stable/modules/cross_validation.html","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":127,"lines":{"from":1,"to":22}}}},{"pageContent":"How to generate cross-validation splits\n\n128\n\nfrom sklearn.model_selection import KFold\n\nX = [\"a\", \"b\", \"c\", \"d\"]\n\nkf = KFold(n_splits=2)\n\nfor train, test in kf.split(X):\n\n   print(f\"{train} {test}\")\n\n\n\n\n\nReturns the \nindices assigned \nto train/test\n\nhttps://scikit-learn.org/stable/modules/cross_validation.html","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":128,"lines":{"from":1,"to":23}}}},{"pageContent":"How to generate cross-validation splits\n\n129\n\nfrom sklearn.model_selection import KFold\n\nX = [\"a\", \"b\", \"c\", \"d\"]\n\nkf = KFold(n_splits=2)\n\nfor train, test in kf.split(X):\n\n   print(f\"{train} {test}\")\n\n[2 3] [0 1]\n\n[0 1] [2 3]\n\n\n\n\nhttps://scikit-learn.org/stable/modules/cross_validation.html","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":129,"lines":{"from":1,"to":22}}}},{"pageContent":"How to generate cross-validation splits\n\n130\n\nfrom sklearn.model_selection import KFold\n\nX = [\"a\", \"b\", \"c\", \"d\"]\n\nkf = KFold(n_splits=2)\n\nfor train, test in kf.split(X):\n\n   print(f\"{train} {test}\")\n\n[2 3] [0 1]\n\n[0 1] [2 3]\n\n\n\n\nhttps://scikit-learn.org/stable/modules/cross_validation.html\n \n\nSplit 1: Train set indices 2,3 (“c”, “d”); \n\ntest set indices 0,1 (“a”, “b”)","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":130,"lines":{"from":1,"to":27}}}},{"pageContent":"How to generate cross-validation splits\n\n131\n\nfrom sklearn.model_selection import KFold\n\nX = [\"a\", \"b\", \"c\", \"d\"]\n\nkf = KFold(n_splits=2)\n\nfor train, test in kf.split(X):\n\n   print(f\"{train} {test}\")\n\n[2 3] [0 1]\n\n[0 1] [2 3]\n\n\n\n\nhttps://scikit-learn.org/stable/modules/cross_validation.html\n \n\nSplit 2: Train set indices 0,1 (“a”, “b”); \n\ntest set indices 2,3 (“c”, “d”)","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":131,"lines":{"from":1,"to":27}}}},{"pageContent":"How to generate cross-validation splits\n\n132\n\nfrom sklearn.model_selection import KFold\n\nX = [\"a\", \"b\", \"c\", \"d\"]\n\nkf = KFold(n_splits=2)\n\nfor train, test in kf.split(X):\n\n   print(f\"{train} {test}\")\n\n[2 3] [0 1]\n\n[0 1] [2 3]\n\n\n\n\nhttps://scikit-learn.org/stable/modules/cross_validation.html\n \n\nCalculate evaluation metrics on split 1\n\nCalculate evaluation metrics on split 2","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":132,"lines":{"from":1,"to":27}}}},{"pageContent":"How to generate cross-validation splits\n\n133\n\nfrom sklearn.model_selection import KFold\n\nX = [\"a\", \"b\", \"c\", \"d\"]\n\nkf = KFold(n_splits=2)\n\nfor train, test in kf.split(X):\n\n   print(f\"{train} {test}\")\n\n[2 3] [0 1]\n\n[0 1] [2 3]\n\n\n\n\nhttps://scikit-learn.org/stable/modules/cross_validation.html\n \n\nCalculate the mean / stdev of \nevaluation metrics across splits","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":133,"lines":{"from":1,"to":26}}}},{"pageContent":"134","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":134,"lines":{"from":1,"to":1}}}},{"pageContent":"135\n\nhttps://pub.towardsai.net/importance-of-k-fold-cross-validation-in-machine-learning-a0d76f49493e\n \n\nWhen you realize k-fold cross validation can only \n\nvalidate your models, not yourself...","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":135,"lines":{"from":1,"to":8}}}},{"pageContent":"136","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":136,"lines":{"from":1,"to":1}}}},{"pageContent":"Sliding Windows\n\n●\nFor time series: take the concept of cross \nvalidation, but tweak it so that you can’t use \nthe \nfuture \nto model the \npast\n\n○\nThis is cheating (“data leakage”) and will \ngive you overly-good results!\n\n\n137","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":137,"lines":{"from":1,"to":16}}}},{"pageContent":"Sliding Windows\n\n●\nFor time series: take the concept of cross \nvalidation, but tweak it so that you can’t use \nthe \nfuture \nto model the \npast\n\n○\nThis is cheating (“data leakage”) and will \ngive you overly-good results!\n\n\n●\nInstead, \nslide\n your test/validation sets \nforward by a “time \nwindow\n” unit\n\n\n138","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":138,"lines":{"from":1,"to":25}}}},{"pageContent":"Sliding Windows\n\n139\n\nhttps://towardsdatascience.com/time-based-cross-validation-d259b13d42b8\n \n\nValidating\n\nTraining","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":139,"lines":{"from":1,"to":10}}}},{"pageContent":"Sliding Windows\n\n140\n\nhttps://towardsdatascience.com/time-based-cross-validation-d259b13d42b8\n \n\nMultiple splits, each one \nwith a different train and \nvalidation set\n\nValidating\n\nTraining","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":140,"lines":{"from":1,"to":14}}}},{"pageContent":"Sliding Windows\n\n141\n\nhttps://towardsdatascience.com/time-based-cross-validation-d259b13d42b8\n \n\nNever peeking at “future” \ntest data when training \nthe model\n\nValidating\n\nTraining","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":141,"lines":{"from":1,"to":14}}}},{"pageContent":"Data Leakage\n\n●\nWe don’t want to “leak” information between \nthe train / validation / test sets, in order to \nkeep the val / test set evaluations \nfully\n \nseparate\n from the train set evaluations\n\n\n○\n“Leaking” via time\n\n142","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":142,"lines":{"from":1,"to":16}}}},{"pageContent":"Data Leakage\n\n●\nWe don’t want to “leak” information between \nthe train / validation / test sets, in order to \nkeep the val / test set evaluations \nfully\n \nseparate\n from the train set evaluations\n\n\n○\n“Leaking” via time\n\n○\n“Leaking” via normalization\n\n143","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":143,"lines":{"from":1,"to":19}}}},{"pageContent":"Input variables are on different \nscales: \nnormalize\n with z-scores\n\ndensity\n\ntotal sulfur\n\n144","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":144,"lines":{"from":1,"to":10}}}},{"pageContent":"https://mimno.infosci.cornell.edu/info2950/interactive/wine.html\n \n\n145","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":145,"lines":{"from":1,"to":4}}}},{"pageContent":"Normalizing \n→\n data leakage?\n\n●\nWhich of the following would prevent data \nleakage when normalizing data?\n\nA: \nFirst generate train/test splits, then \nnormalize within train set, and separately \nnormalize within test set \n\nB: \nFirst normalize all the data, then generate \ntrain/test splits\n\n146\n\n琀\n琀","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":146,"lines":{"from":1,"to":21}}}},{"pageContent":"Normalizing \n→\n data leakage?\n\n●\nWhich of the following would prevent data \nleakage when normalizing data?\n\nA: First generate train/test splits, then \nnormalize within train set, and separately \nnormalize within test set\n \n\nIf you instead normalize across all the data, the mean and \nstdev you calculate will incorporate data across both \ntrain/test sets, effectively “leaking” information\n\n147","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":147,"lines":{"from":1,"to":18}}}},{"pageContent":"How to do this CV stuff in Python?\n\n148\n\nCheck the Scikit Learn documentation:\n\nhttps://scikit-learn.org/stable/modules/\ncross_validation.html","metadata":{"source":"docs/INFO_2950/INFO2950_Lec14_20231016.pdf","pdf":{"version":"1.10.100","info":{"PDFFormatVersion":"1.7","IsAcroFormPresent":false,"IsXFAPresent":false,"Creator":"PDFium","Producer":"PDFium","CreationDate":"D:20231206224521"},"metadata":null,"totalPages":148},"loc":{"pageNumber":148,"lines":{"from":1,"to":8}}}}]